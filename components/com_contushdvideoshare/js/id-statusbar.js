 var console;var identity=(typeof identity=="undefined")?{}:identity;identity.urls={help:"/users/help",feedback:"/users/feedback",login:"/users/signin",signin:"/users/signin",signout:"/users/signout",settings:"/users/dash",register:"/users/register",forgotpw:"/users/recover",terms:"http://www.bbc.co.uk/terms",privacy:"http://www.bbc.co.uk/privacy/"};identity.statusbar=function(){var B={},Q={signedIn:{common:'<div class="id-in blq-rst" id="id-status{gel.navid}"><h2><span class="blq-hide">Your BBC iD: </span>{username.markup}</h2><ul>{profile.markup}<li>{settings.markup}</li><li><a name="idLogout" class="blq-nogo has-ptrt" id="idLogout" href="{signout.link}">{signout.title}</a></li></ul></div>',gel:'<div class="id-in id-gel" id="id-status">{username.markup}</div>'},signedOut:{gvl2:'<div class="id-out" id="id-status"><h2 class="blq-hide">BBC iD</h2><ul><li>{signin.markup}</li><li>{register.markup}</li></ul></div>',gel:'<div class="id-out id-gel" id="id-status"><h2 class="blq-hide">BBC iD</h2>{signin.markup}</div>'},signin:{active:'<strong id="idSignin">{signin.title}</strong>',link:'<a href="{signin.link}" id="idSignin" class="blq-nogo has-ptrt">{signin.title}</a>'},register:{active:'<strong id="idRegister">{register.title}</strong>',link:'<a href="{register.link}" id="idRegister" class="blq-nogo has-ptrt">{register.title}</a>'},username:{abbr:'<abbr title="{username.title}">{username.abbr}</abbr>',span:'<span class="idUsername blq-nogo{username.class}" id="idUsername">{username.title}</span>',link:'<a class="idUsername blq-nogo{username.class}" id="idUsername" href="{username.link}"{gel.navAnchor}>{username.title}</a>'},profile:{active:"<li><strong>{profile.title}</strong></li>",link:'<li><a href="{profile.link}" class="blq-nogo">{profile.title}</a></li>'},settings:{active:'<strong id="idDash">{settings.title}</strong>',link:'<a name="idDash" class="blq-nogo has-ptrt" id="idDash" href="{settings.link}">{settings.title}</a>'}},O={"en-GB":{signin:{title:"Sign in"},signout:{title:"Sign out"},register:{title:"Register"},profile:{title:"Profile"},settings:{title:"Settings"}},"cy-GB":{signin:{title:"Mewngofnodi"},signout:{title:"Allgofnodi"},register:{title:"Cofrestru"},profile:{title:"Proffeil"},settings:{title:"Dewisiadau"}}},H,F,A,P="en-GB",T,L,N,J;var D=function(V){if(O[V]){return O[V]}return O["en-GB"]};var E=function(V,X){var Y,W={};for(Y in V){W[Y]=V[Y]}for(Y in X){if(W[Y]&&(typeof W[Y]=="object")&&(typeof X[Y]=="object")){W[Y]=E(W[Y],X[Y])}else{W[Y]=X[Y]}}return W};var C=function(){T={profile:{link:identity.user.profileUrl},register:{link:idProperties.secureServer+identity.urls.register+"?s=sb"},settings:{link:idProperties.secureServer+identity.urls.settings+"?s=sb"},signout:{link:idProperties.secureServer+identity.urls.signout+"?s=sb"},signin:{link:idProperties.secureServer+identity.urls.signin+"?s=sb"},username:{title:function(){if(!identity.user.signedIn){return""}var W=identity.user.displayName;if(!W){W=identity.user.username}if(!W){return""}var V=A?14:18;if(W.length>=V){return'<abbr title="'+W+'">'+W.substring(0,V-1)+"&#8230;</abbr>"}return W}()}};T=E(T,D(P))};B.refresh=function(){C()};if(!identity.status){identity.status={enableJavaScript:function(){N=true}}}B.init=function(W){H=W;F=H.dom.get;var V=F("#id-status");A=V.hasClass("id-gel");N=idProperties&&(idProperties.dynamicServer==window.location.protocol+"//"+window.location.hostname||idProperties.env=="stage"||idProperties.env=="live");if(V&&V.length>0&&V.hasClass("id-jsstatusbar")){P=F("#blq-container-inner").prop("lang");B.refresh();if(identity.user.signedIn){U(V)}else{K(V)}if(!identity.user.signedIn){var X=F("#idSignin");if(X.length>0){H.events.addListener(X,"click",function(Y){if(!G()&&N){F("#id-status").addClass("id-status-working");B.loadResources();H.events.addListener(identity,"id-initialised",function(Z){identity.status.enableJavaScript();identity.showSigninPanel(Y)});Y.stopPropagation();Y.preventDefault()}})}}}if(A){B.menu.init(H)}if(!J&&G()){H.events.fire(identity,"id-resources-loaded");J=true}};var M="script/";var I={"id-status.js":{},"id-app.js":{},"id-forms.js":{},"id-glow-panel-extensions.js":{}};B.loadResources=function(X){var W=false;if(X&&X.call){H.events.addListener(identity,"id-resources-loaded",X)}for(var V in I){if(I[V].request){continue}W=true;I[V].request=H.net.loadScript(idProperties.assetPath+M+V,{useCache:true})}return W};B.scriptLoadCallback=function(V){I[V].loaded=true;if(!J&&G()){if(H&&H.events){H.events.fire(identity,"id-resources-loaded");J=true}}};var G=function(){for(var V in I){if(!I[V].loaded){return false}}return true};var R=function(W,X,V){if(V&&typeof V=="object"){V=E(T,V)}else{V=T}return H.lang.interpolate(Q[W][X],V)};var S=function(W,V){var X=false;return R(W,(X)?"active":"link",V)};var U=function(V){var W={gel:{},username:{},profile:{},settings:{}};var X="";if(A){X=idProperties.secureServer+identity.urls.settings}else{if(identity.user.hasProfile){X=identity.user.profileUrl}}if(A){W.username["markup"]=R("username","link",{username:{"class":"",link:"#id-nav"},gel:{navAnchor:""}});H.dom.create(R("signedIn","gel",W)).insertBefore(V)}W.gel["navid"]=(A?"-nav":"");W.username["markup"]=R("username",(X?"link":"span"),{username:{"class":"",link:X},gel:{navAnchor:(A?' name="id-nav"':"")}});W.profile["markup"]=(A&&identity.user.hasProfile)?S("profile"):"";W.settings["markup"]=S("settings");V.replaceWith(H.dom.create(R("signedIn","common",W)))};var K=function(V){var W={signin:{markup:S("signin")},register:{}};if(!A){W.register["markup"]=S("register")}V.replaceWith(H.dom.create(R("signedOut",(A?"gel":"gvl2"),W)))};return B}();identity.statusbar.menu=function(){var C={},I,D;var G=0.35,B=98;var A,E;var F,H;C.init=function(J){I=J;D=I.dom.get;A=D("#id-status-nav");if(!A||A.length==0){return }E=D("#id-status .idUsername");A.appendTo("#blq-container-inner");F=false;H="";C.hide(false);I.events.addListener(D("#id-status .idUsername,#id-status-nav .idUsername"),"click",function(K){if(F){C.hide()}else{C.show()}K.preventDefault()});I.events.addListener(document.body,"click",function(K){if(!D(K.source).isWithin(D("#id-status,#id-status-nav"))){C.hide()}})};C.hide=function(J){if(typeof J=="undefined"){J=true}if(J){if(!F){return }var K;I.anim.css(A,G,{opacity:0},{onComplete:function(){A.css("display","none");if(H!=B){idMenuAnimation=I.anim.css(E,0.2,{width:H+"px"},{onComplete:function(){F=false;idMenuAnimation=""}}).start()}F=false}}).start()}else{A.css("opacity",0);A.css("display","none");F=false}};C.show=function(J){if(F){return }if(typeof J=="undefined"){J=true}A.css("display","block");F=true;if(J){if(!H){H=E.width()}if(H==B){K=I.anim.fadeIn(A,G)}else{var K;I.anim.css(E,G/2,{width:B+"px"},{onFrame:function(){if(!K&&this.value>=0.5){K=I.anim.fadeIn(A,G)}}}).start()}}};return C}();if(!identity.util){identity.util={}}if(!identity.util.getCookie){identity.util.getCookie=function(B){var D=[B,"="].join("");var A=document.cookie.split(";");for(var C=0;C<A.length;C++){var E=A[C];while(E.charAt(0)==" "){E=E.substring(1,E.length)}if(E.indexOf(D)===0){return E.substring(D.length,E.length)}}return null}}identity.user=function(){var A,B={},C;B.refresh=function(){C=identity.util.getCookie("IDENTITY");A=C?C.split("%7C"):null;if(C!=A&&A.length>=5){B.userid=A[0];B.username=A[1];B.displayName=unescape(A[2]).replace(/\+/g," ");B.hasProfile=A[4]!=0;if(B.hasProfile){B.profileUrl=idProperties.dynamicServer+"/users/"+B.username}B.status="loggedin";B.signedIn=true}else{B.username="";B.status="loggedout";B.userid=0;B.signedIn=false}};B.refresh();return B}();if(gloader&&gloader.load){gloader.load(["glow","1","glow.anim","glow.dom","glow.net","glow.events"],{onLoad:function(A){A.ready(function(){try{identity.statusbar.init(A)}catch(B){if(console&&console.log){console.log("Could not initialise BBC iD Statusbar: "+B)}}})}})};