WFMediaPlayer.init({params:{extensions:'mp3,mp4,flv,f4v',dimensions:{'audio':{width:300,height:35}},path:'media/jce/mediaplayer/mediaplayer.swf'},props:{autoPlay:0,bufferingOverlay:0,controlBarAutoHide:1,controlBarMode:'docked',loop:0,muted:0,playButtonOverlay:1,bufferingOverlay:1,volume:1,audioPan:0},type:'flash',setup:function(){$('#mediaplayer_volume, #mediaplayer_audioPan').each(function(){var n=this;$('<span id="'+$(n).attr('id')+'_slider" class="ui-slider-block"></span>').insertAfter(this).slider()})$('#mediaplayer_volume').change(function(){$('#mediaplayer_volume_slider').slider('value',$(this).val()*100)});$('#mediaplayer_audioPan').change(function(){$('#mediaplayer_audioPan_slider').slider('value',($(this).val()*10)+20)});$('#mediaplayer_volume_slider').slider('option',{min:0,max:100,step:10,value:$('#mediaplayer_volume').val()*100,slide:function(event,ui){$('#mediaplayer_volume').val(ui.value/100)}});$('#mediaplayer_audioPan_slider').slider('option',{min:10,max:30,step:1,value:($('#mediaplayer_audioPan').val()*10)+20,slide:function(event,ui){$('#mediaplayer_audioPan').val((ui.value-20)/10)}})},isSupported:function(data){var r,file='',ext=tinymce.explode(this.getParam('extensions')).join('|'),re=new RegExp('\.('+ext+')$');var src=data.src||data.data||'';if(data.param){var fv=this.parseValues(data.param.flashvars||'');if(fv){file=fv.src||''}}r=re.test(src)||re.test(file);if(!r){return new RegExp(this.getPath()).test(src)}return r},getValues:function(s){var self=this,data=[];data.push('src='+encodeURIComponent($.String.path(tinyMCEPopup.getParam('document_base_url'),s)));$(':input','#mediaplayer_options').each(function(){var k=$(this).attr('id'),v=$(this).val();k=k.substr(k.indexOf('_')+1);if(k=='volume'){if(v>1){v=v/100}}if($(this).is(':checkbox')){v=$(this).is(':checked')?1:0}if(self.props[k]===v||v==''){return}data.push(k+'='+encodeURIComponent(v))});return{'src':this.getPath(),'type':'application/x-shockwave-flash','param':{'flashvars':data.join('&'),'allowfullscreen':true,'wmode':'opaque'}}},parseValues:function(s){var data={},o=$.String.query(s);$.each(o,function(k,v){switch(k){case'src':data['src']=tinyMCEPopup.editor.convertURL(v);break;case'volume':data['volume']=v*100;break;default:data[k]=v;break}});return data},setValues:function(data){var fv=data.param.flashvars||'';var at=this.parseValues(fv);$.each(at,function(k,v){$('#'+k).val(v)})},onSelectFile:function(){},onInsert:function(){var src=$('#src').val(),mp3=/\.mp3$/.test(src),dimensions=this.getParam('dimensions');if(mp3&&dimensions.audio){$('#width').val(dimensions.audio.width);$('#height').val(dimensions.audio.height)}$('#flash_wmode').val('opaque');$('#flash_allowfullscreen').attr('checked',!mp3);$('#flash_menu').attr('checked',true)}});